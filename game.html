<!doctype html>
<html lang="zh-Hant">
<head><meta charset="utf-8" /><title>大螢幕</title></head>
<body style="background:#040b16;color:#fff;text-align:center;font-family:sans-serif">
  <h1>PIN: <span id="pinShow">----</span></h1>
  <div id="grid" style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;padding:20px"></div>
  <div id="win" style="font-size:100px;color:#32d583;font-weight:bold"></div>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCmbM5JgUphfWil3ImVi7GFtVrfeE7jzm4",
      authDomain: "fe55-dbd87.firebaseapp.com",
      databaseURL: "https://fe55-dbd87-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "fe55-dbd87"
    };
    firebase.initializeApp(firebaseConfig);
    const pin = new URLSearchParams(location.search).get('pin');
    document.getElementById('pinShow').textContent = pin;
    firebase.database().ref(`rooms/${pin}`).on('value', snap => {
      const room = snap.val(); if(!room) return;
      const grid = document.getElementById('grid'); grid.innerHTML = '';
      const last = room.history ? room.history[room.history.length-1] : null;
      if(last) last.dealt.forEach(d => {
        grid.innerHTML += `<div style="height:250px;background:#222"><img src="${d.photo}" style="width:100%;height:100%;object-fit:cover"></div>`;
      });
      document.getElementById('win').textContent = room.buzz?.locked ? room.buzz.winnerName : "";
    });
  </script>
</body>
</html>
